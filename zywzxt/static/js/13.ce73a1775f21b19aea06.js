webpackJsonp([13],{WSUC:function(e,t){},suDj:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),i=a.n(n),l=(a("mw3O"),{data:function(){return{userrole:{},yytjpage:"yytjpage",wzqkpage:"wzqkpage",rangeDate:null,search_obj:{pname:null,startDate:null,endDate:null,keyWords:null,patientId:null,pageNum:1,pageSize:10,startAge:"",endAge:"",residence:"",gender:""},multipleSelectionAll:[],multipleSelection:[],idKey:"inquiryId",tableData:{list:[],pageNum:1,pageSize:10,total:0},pickerOptions1:{disabledDate:function(e){return e.getTime()>Date.now()}}}},computed:{},watch:{rangeDate:function(e,t){this.search_obj.startDate=this.$common.dateFormatStr(this.rangeDate[0],"yyyy-MM-dd"),this.search_obj.endDate=this.$common.dateFormatStr(this.rangeDate[1],"yyyy-MM-dd")}},created:function(){document.title="病历管理",this.initPage(),this.roleuser=this.$store.getters.gettersroleuser},methods:{changeDate:function(e){console.log(e);""!=e&&null!=e||(this.search_obj.startDate=null,this.search_obj.endDate=null,this.rangeDate=null)},typeIndex:function(e){return console.log("序号：",e),e+(this.pageNum-1)*this.pageSize+1},rowClassname:function(){return"rowClassname"},headerClassname:function(){return"headerClassname"},handleClick:function(e){console.log(e)},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.changePageCoreRecordData(),this.search_obj.pageNum=e,this.getblList()},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,setTimeout(function(){t.changePageCoreRecordData()},50)},setSelectRow:function(){if(this.multipleSelectionAll&&!(this.multipleSelectionAll.length<=0)){var e=this.idKey,t=[];this.multipleSelectionAll.forEach(function(a){t.push(a[e])}),this.$refs.table.clearSelection();for(var a=0;a<this.tableData.list.length;a++)t.indexOf(this.tableData.list[a][e])>=0&&this.$refs.table.toggleRowSelection(this.tableData.list[a],!0)}},changePageCoreRecordData:function(){var e=this.idKey,t=this;if(this.multipleSelectionAll.length<=0)this.multipleSelectionAll=this.multipleSelection;else{var a=[];this.multipleSelectionAll.forEach(function(t){a.push(t[e])});var n=[];this.multipleSelection.forEach(function(i){n.push(i[e]),a.indexOf(i[e])<0&&t.multipleSelectionAll.push(i)});var i=[];this.tableData.list.forEach(function(t){n.indexOf(t[e])<0&&i.push(t[e])}),i.forEach(function(n){if(a.indexOf(n)>=0)for(var i=0;i<t.multipleSelectionAll.length;i++)if(t.multipleSelectionAll[i][e]==n){t.multipleSelectionAll.splice(i,1);break}})}},initPage:function(){var e=JSON.parse(window.localStorage.getItem("pathParams"));""!=e.data.pname&&(this.search_obj.pname=e.data.pname),e.data.pageNum&&(this.search_obj.pageNum=e.data.pageNum),e.data.pageSize&&(this.search_obj.pageSize=e.data.pageSize),e.data.keyWords&&(this.search_obj.keyWords=e.data.keyWords),e.data.startDate&&(this.search_obj.startDate=e.data.startDate),e.data.endDate&&(this.search_obj.endDate=e.data.endDate),e.data.patientId&&(this.search_obj.patientId=e.data.patientId),e.data.startAge&&(this.search_obj.startAge=e.data.startAge),e.data.endAge&&(this.search_obj.endAge=e.data.endAge),e.data.residence&&(this.search_obj.residence=e.data.residence),e.data.gender&&(this.search_obj.gender=e.data.gender),this.getblList()},opencomfigMethod:function(e,t,a){this.$common.openComfigDialog(e,t,a,this)},getblList:function(){var e=this,t=this.search_obj;console.log("参数",t);e.$http.get("/MrManage/getMrList",{params:t}).then(function(t){console.log(t),"1"==t.code?(e.tableData=t.data.pageInfo,console.log(e.tableData),setTimeout(function(){e.setSelectRow()},50)):e.$common.openErrorMsgBox(t.msg,e)}).catch(function(t){e.$common.openErrorMsgBox(t,e)})},gotoWzxxPage:function(e){var t={pId:e.pId,inquiryId:e.inquiryId},a=new Object;a.path="wjxxpage",a.data=t,this.$store.dispatch("setPathParams",i()(a));var n=new Object;n.path="blglpage",n.data=this.search_obj,this.$store.dispatch("setPrePathParams",i()(n)),this.$common.GotoPage("wjxxpage",t,this)},delDailyPatient:function(e){var t=this,a=t.$common.openLoading("删除病历!",t);t.$http.delete("/MrManage/deleteDailyPatient?inquiryid="+e.inquiryId).then(function(e){a.close(),"1"==e.code&&(t.$common.openSuccessMsgBox("删除成功",t),t.getblList())}).catch(function(e){a.close(),t.$common.openErrorMsgBox(e,t)})},gotoyfpage:function(e){var t={pId:e.pId,inquiryId:e.inquiryId,lastinquiryId:""},a=new Object;a.path="bryfpage",a.data=t,this.$store.dispatch("setPathParams",i()(a));var n=new Object;n.path="blglpage",n.data=this.search_obj,this.$store.dispatch("setPrePathParams",i()(n)),this.$common.GotoPage("bryfpage",t,this)},exportBlList:function(){var e=this,t=new Array,a={inquiryIdList:"",all:!1,patientId:null};if("[]"==i()(this.multipleSelectionAll))return e.$common.openErrorMsgBox("请选中要导出的病历信息",e),!1;for(var n=0;n<this.multipleSelectionAll.length;n++)t.push(this.multipleSelectionAll[n].inquiryId);a.inquiryIdList=t,console.log(i()(a));var l=e.$common.openLoading("病历导出中，请耐心等待",e);e.$http.post("/dataStatistics/getInquiryInfoList",a).then(function(t){l.close(),"1"==t.code&&"{}"!=i()(t.data)?t.data.inquiryInfo&&"{}"!=i()(t.data.inquiryInfo)&&e.$exportPrint(t.data.inquiryInfo,{}):e.$common.openErrorMsgBox(t.msg,e)}).catch(function(t){l.close(),e.$common.openErrorMsgBox(t,e)})},exportWord:function(){var e=this,t={inquiryIdList:[],all:!1,patientId:null};if("[]"==i()(this.multipleSelectionAll))return e.$common.openErrorMsgBox("请选中要导出的病历信息",e),!1;for(var a=0;a<this.multipleSelectionAll.length;a++)t.inquiryIdList.push(this.multipleSelectionAll[a].inquiryId);console.log(t);var n="/index/getPatientInfoWord?all=false";t.inquiryIdList.forEach(function(e){n+="&inquiryIdList="+e}),console.log(n);var l=e.$common.openLoading("病历word文档导出中，请耐心等待",e);e.$http.post(n,{}).then(function(e){console.log(e),l.close();var t=new Blob([e],{type:"application/msword"}),a=URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.setAttribute("download","病人病例"),document.body.appendChild(n),n.click()}).catch(function(t){l.close(),e.$common.openErrorMsgBox(t,e)})}}}),o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"blgl-container"},[a("div",{staticClass:"search-row"},[a("div",{staticClass:"search-input-item"},[a("el-input",{staticStyle:{width:"180px","margin-right":"10px","margin-left":"1px"},attrs:{placeholder:"病人姓名"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.pname,callback:function(t){e.$set(e.search_obj,"pname",t)},expression:"search_obj.pname"}})],1),e._v(" "),a("div",{staticClass:"search-input-item"},[a("el-input",{staticStyle:{width:"180px","margin-right":"10px","margin-left":"1px"},attrs:{placeholder:"性别"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.gender,callback:function(t){e.$set(e.search_obj,"gender",t)},expression:"search_obj.gender"}})],1),e._v(" "),a("div",{staticClass:"search-input-item"},[a("el-input",{staticStyle:{width:"180px","margin-right":"10px","margin-left":"1px"},attrs:{placeholder:"来源地"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.residence,callback:function(t){e.$set(e.search_obj,"residence",t)},expression:"search_obj.residence"}})],1),e._v(" "),a("div",{staticClass:"search-input-item"},[a("el-input",{staticStyle:{width:"127px","margin-right":"10px","margin-left":"1px",display:"inline-block"},attrs:{placeholder:"年龄"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.startAge,callback:function(t){e.$set(e.search_obj,"startAge",t)},expression:"search_obj.startAge"}}),e._v("-\n            "),a("el-input",{staticStyle:{width:"127px","margin-right":"10px","margin-left":"1px"},attrs:{placeholder:"年龄"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.endAge,callback:function(t){e.$set(e.search_obj,"endAge",t)},expression:"search_obj.endAge"}})],1),e._v(" "),a("div",{staticClass:"search-range-date-item search-input-item1"},[a("el-date-picker",{staticClass:"rq-input",attrs:{"picker-options":e.pickerOptions1,type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy/MM/dd"},on:{change:e.changeDate,blur:e.getblList},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1),e._v(" "),a("div",{staticClass:"search-input-item"},[a("el-input",{staticStyle:{width:"300px","margin-right":"40px"},attrs:{placeholder:"输入关键字"},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.getblList(t):null}},model:{value:e.search_obj.keyWords,callback:function(t){e.$set(e.search_obj,"keyWords",t)},expression:"search_obj.keyWords"}})],1),e._v(" "),a("div",{staticClass:"search-row-btn-group"},[a("el-button",{staticClass:"btn-default btn-deault-size btn-color-blue",on:{click:e.getblList}},[e._v("查询")])],1)]),e._v(" "),a("div",{staticClass:"table-continer"},[a("el-table",{ref:"table",staticStyle:{border:"1px solid #ebeef5","overflow-y":"auto",height:"100%",width:"100%"},attrs:{data:e.tableData.list,"header-row-class-name":e.headerClassname,"row-class-name":e.rowClassname,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"60"}}),e._v(" "),a("el-table-column",{attrs:{prop:"index",width:"130px",label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.$index+(e.tableData.pageNum-1)*e.tableData.pageSize+1)+" ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"pName",label:"姓名",width:"150"}}),e._v(" "),a("el-table-column",{attrs:{prop:"firstDate",label:"初次就诊时间",width:"220"}}),e._v(" "),a("el-table-column",{attrs:{prop:"inquiryDate",label:"就诊时间",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"times",label:"第几次",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"gender",label:"性别",width:"90"}}),e._v(" "),a("el-table-column",{attrs:{prop:"age",label:"年龄",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"residence",label:"来源地",width:"260"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"510"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn-font-default bnt-font-color",attrs:{type:"text"},on:{click:function(a){e.opencomfigMethod("请确认删除病例",e.delDailyPatient,t.row)}}},[e._v("删除病历")]),e._v(" "),a("el-button",{staticClass:"btn-font-default",attrs:{type:"text"},on:{click:function(a){e.gotoWzxxPage(t.row)}}},[e._v("查看四诊")]),e._v(" "),a("el-button",{staticClass:"btn-font-default",attrs:{type:"text"},on:{click:function(a){e.gotoyfpage(t.row)}}},[e._v("查看病历")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"foot-container"},[a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{background:"","current-page":e.tableData.pageNum,"page-size":e.tableData.pageSize,layout:"total, prev, pager, next, jumper",total:e.tableData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),2==e.roleuser?a("div",{staticClass:"search-row-btn-group"},[a("el-button",{staticClass:"btn-default btn-deault-size btn-color-blue",on:{click:e.exportBlList}},[e._v("导出病历")]),e._v(" "),a("el-button",{staticClass:"btn-default btn-deault-size btn-color-blue",on:{click:e.exportWord}},[e._v("导出word")])],1):e._e()])])},staticRenderFns:[]};var s=a("VU/8")(l,o,!1,function(e){a("WSUC")},null,null);t.default=s.exports}});
//# sourceMappingURL=13.ce73a1775f21b19aea06.js.map