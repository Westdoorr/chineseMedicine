webpackJsonp([15],{EO0L:function(e,t){},sq3U:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),l=(a("mw3O"),{data:function(){return{roleuser:{},search_obj:{pname:null,patientId:null,pageNum:1,pageSize:10},diagnoseLabels:"诊断标签：",multipleSelectionAll:[],multipleSelection:[],idKey:"inquiryId",tableData:{list:[],pageNum:1,pageSize:10,total:0}}},created:function(){this.initPage(),this.roleuser=this.$store.getters.gettersroleuser},methods:{rowClassname:function(){return"rowClassname"},headerClassname:function(){return"headerClassname"},handleClick:function(e){console.log("当前行",e);var t={pId:e.pId,inquiryId:e.inquiryId,lastinquiryId:"",pname:this.search_obj.pname},a=(e.pId,e.inquiryId,new Object);a.path="bryfpage",a.data=t,a.fh_=t,this.$store.dispatch("setPathParams",n()(a));var i=new Object;i.path="grblglpage",i.data=this.search_obj,i.is_display_xj=!1,i.is_display_fh=!1,this.$store.dispatch("setPrePathParams",n()(i)),this.$common.GotoPage("bryfpage",t,this)},handleSizeChange:function(e){console.log("每页 "+e+" 条")},handleCurrentChange:function(e){this.changePageCoreRecordData(),this.search_obj.pageNum=e,this.getBrList(this.search_obj)},handleSelectionChange:function(e){var t=this;this.multipleSelection=e,setTimeout(function(){t.changePageCoreRecordData()},50)},setSelectRow:function(){if(this.multipleSelectionAll&&!(this.multipleSelectionAll.length<=0)){var e=this.idKey,t=[];this.multipleSelectionAll.forEach(function(a){t.push(a[e])}),this.$refs.table.clearSelection();for(var a=0;a<this.tableData.list.length;a++)t.indexOf(this.tableData.list[a][e])>=0&&this.$refs.table.toggleRowSelection(this.tableData.list[a],!0)}},changePageCoreRecordData:function(){var e=this.idKey,t=this;if(this.multipleSelectionAll.length<=0)this.multipleSelectionAll=this.multipleSelection;else{var a=[];this.multipleSelectionAll.forEach(function(t){a.push(t[e])});var i=[];this.multipleSelection.forEach(function(n){i.push(n[e]),a.indexOf(n[e])<0&&t.multipleSelectionAll.push(n)});var n=[];this.tableData.list.forEach(function(t){i.indexOf(t[e])<0&&n.push(t[e])}),n.forEach(function(i){if(a.indexOf(i)>=0)for(var n=0;n<t.multipleSelectionAll.length;n++)if(t.multipleSelectionAll[n][e]==i){t.multipleSelectionAll.splice(n,1);break}})}},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},initPage:function(){var e=JSON.parse(window.localStorage.getItem("pathParams"));""!=e.data.pId&&e.data.pId&&(this.search_obj.patientId=e.data.pId),""!=e.data.patientId&&e.data.patientId&&(this.search_obj.patientId=e.data.patientId),""!=e.data.pname&&(this.search_obj.pname=e.data.pname),e.data.pageNum&&(this.search_obj.pageNum=e.data.pageNum),e.data.pageSize&&(this.search_obj.pageSize=e.data.pageSize),this.getBrDiagnoseLabels(this.search_obj.patientId),this.getBrList(this.search_obj)},getBrDiagnoseLabels:function(e){var t=this;t.$http.get("/inquiry/getOnePatientLabels?patientId="+e).then(function(e){if("1"==e.code){var a=n()(e.data.diagnoseLabels);a=a.replace(/[\[\]\"]*/g,""),t.diagnoseLabels=t.diagnoseLabels+a}else t.$common.openErrorMsgBox(e.msg,t)}).catch(function(e){t.$common.openErrorMsgBox(e,t)})},getBrList:function(e){var t=this;t.$http.get("/MrManage/getMrList",{params:e}).then(function(e){console.log("当前病人",e),"1"==e.code?"[]"!=n()(e.data.pageInfo.list)&&(t.tableData=e.data.pageInfo,setTimeout(function(){t.setSelectRow()},50)):t.$common.openErrorMsgBox(e.msg,t)}).catch(function(e){t.$common.openErrorMsgBox(e,t)})},GobackPage:function(){this.$common.GoBackPrePage("grblglpage",this.search_obj,this)},exportBlList:function(){var e=this,t={inquiryIdList:[],all:!1,patientId:null};if("[]"==n()(this.multipleSelectionAll))return e.$common.openErrorMsgBox("请选中要导出的病历信息",e),!1;for(var a=0;a<this.multipleSelectionAll.length;a++)t.inquiryIdList.push(this.multipleSelectionAll[a].inquiryId);console.log(n()(t));var i=e.$common.openLoading("病历导出中，请耐心等待",e);e.$http.post("/dataStatistics/getInquiryInfoList",t).then(function(t){i.close(),"1"==t.code?t.data.inquiryInfo&&"{}"!=n()(t.data.inquiryInfo)&&e.$exportPrint(t.data.inquiryInfo,{}):e.$common.openErrorMsgBox(t.msg,e)}).catch(function(t){i.close(),e.$common.openErrorMsgBox(t,e)})},exportWord:function(){var e=this,t={inquiryIdList:[],all:!1,patientId:null};if("[]"==n()(this.multipleSelectionAll))return e.$common.openErrorMsgBox("请选中要导出的病历信息",e),!1;for(var a=0;a<this.multipleSelectionAll.length;a++)t.inquiryIdList.push(this.multipleSelectionAll[a].inquiryId);console.log(t);var i="/index/getPatientInfoWord?all=false";t.inquiryIdList.forEach(function(e){i+="&inquiryIdList="+e}),console.log(i);var l=e.$common.openLoading("病历word文档导出中，请耐心等待",e);e.$http.post(i,{}).then(function(e){console.log(e),l.close();var t=new Blob([e],{type:"application/msword"}),a=URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.setAttribute("download","病人病例"),document.body.appendChild(i),i.click()}).catch(function(t){l.close(),e.$common.openErrorMsgBox(t,e)})}}}),o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"grblgl-container"},[a("div",{staticClass:"search-row"},[a("div",{staticClass:"search-row-input-item"},[a("el-input",{attrs:{readonly:!0},model:{value:e.diagnoseLabels,callback:function(t){e.diagnoseLabels=t},expression:"diagnoseLabels"}})],1)]),e._v(" "),a("div",{staticClass:"table-div-continer"},[a("div",{staticClass:"table-continer"},[a("el-table",{ref:"table",staticStyle:{width:"1300px",border:"1px solid #ebeef5","overflow-y":"auto"},attrs:{"tooltip-effect":"dark",data:e.tableData.list,"header-row-class-name":e.headerClassname,"row-class-name":e.rowClassname,stripe:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection","min-width":"96"}}),e._v(" "),a("el-table-column",{attrs:{prop:"times",label:"序号",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"pName",label:"姓名",width:"250"}}),e._v(" "),a("el-table-column",{attrs:{prop:"inquiryDate",label:"最近就诊时间","min-width":"260"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"btn-font-default",attrs:{type:"text"},on:{click:function(a){e.handleClick(t.row)}}},[e._v("查看病例")])]}}])})],1)],1)]),e._v(" "),a("div",{staticClass:"foot-container"},[a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{background:"","current-page":e.search_obj.pageNum,"page-size":e.search_obj.pageSize,layout:"total, prev, pager, next, jumper",total:e.tableData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{staticClass:"search-row-btn-group"},[2==e.roleuser?a("el-button",{staticClass:"btn-blue",on:{click:e.exportBlList}},[e._v("导出病历")]):e._e(),e._v(" "),2==e.roleuser?a("el-button",{staticClass:"btn-blue",on:{click:e.exportWord}},[e._v("导出word")]):e._e(),e._v(" "),a("el-button",{staticClass:"btn-default",on:{click:function(t){e.GobackPage()}}},[e._v("返回")])],1)])])},staticRenderFns:[]};var s=a("VU/8")(l,o,!1,function(e){a("EO0L")},null,null);t.default=s.exports}});
//# sourceMappingURL=15.df8ed4addab05f03eae3.js.map